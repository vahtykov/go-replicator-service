# ReplicatorConsumer Configuration

service:
  name: "replicator-consumer"
  contour: "contour_a"        # Идентификатор контура (contour_a или contour_b)
  
database:
  host: "localhost"
  port: 5432
  database: "main_db"
  user: "replicator"
  password: "secret"
  ssl_mode: "disable"         # disable, require, verify-ca, verify-full
  max_open_conns: 10
  max_idle_conns: 5
  conn_max_lifetime: "1h"
  log_queries: true           # Логировать SQL запросы
  
  # ВАЖНО: application_name для защиты от петли репликации
  application_name: "replicator_consumer"
  
kafka:
  brokers:
    - "localhost:9092"
  ssl_enabled: false
  # SSL настройки (если ssl_enabled: true):
  # ssl_ca_cert: "/path/to/ca.pem"
  # ssl_client_cert: "/path/to/client.pem"
  # ssl_client_key: "/path/to/client-key.pem"
  
  # Consumer настройки
  consumer_group: "replicator-consumer-contour_a"  # Уникальная group на каждом контуре
  auto_offset_reset: "earliest"  # earliest, latest
  enable_auto_commit: false       # Ручной commit после успешной обработки
  session_timeout_ms: 30000
  max_poll_interval_ms: 300000
  
  # Топики для подписки (все таблицы с суффиксом _changes)
  topics:
    - "users_changes"
    - "orders_changes"
    - "products_changes"
    # Добавьте все таблицы, требующие репликации
  
logging:
  level: "info"               # debug, info, warn, error
  format: "json"              # json или console
  color: false                # Отключить цветной вывод

# Настройки обработки
processing:
  # Батчевая обработка (сколько сообщений обрабатывать за раз)
  batch_size: 10
  
  # Таймаут обработки одного события
  event_timeout: "30s"
  
  # Стратегия при конфликте версий
  conflict_resolution: "last_write_wins"  # last_write_wins, skip, error

